{
    "project": {
        "name": "hyticallib-i18n",
        "description": "A production-grade, platform-agnostic internationalization (i18n) localization engine for Minecraft server plugins. Provides YAML-based language file loading, ISO-enforced locale registration, fallback merging, UUID-keyed runtime caching for O(1) message lookups, and a pluggable storage interface. Ships with a Bukkit adapter that persists player language preferences via Persistent Data Containers (PDC).",
        "group": "dev.hytical",
        "version": "1.0.0",
        "javaVersion": 21,
        "buildSystem": "Gradle (Kotlin DSL)",
        "entryPoints": [
            {
                "class": "dev.hytical.i18n.I18nBootstrap",
                "description": "The single entry point for bootstrapping the i18n engine. Consumer code calls I18nBootstrap.builder() to configure and build the engine, receiving a fully initialized I18nBootstrap instance that exposes the LangRegistry and LangService."
            }
        ],
        "modules": [
            {
                "name": "hyticallib-i18n-core",
                "path": "hyticallib-i18n-core",
                "description": "Platform-agnostic core module containing all i18n logic: YAML loading, registry, fallback merging, runtime service, storage interface, and the bootstrap builder.",
                "dependencies": [
                    {
                        "artifact": "org.yaml:snakeyaml:2.2",
                        "scope": "api"
                    }
                ]
            },
            {
                "name": "hyticallib-i18n-bukkit",
                "path": "hyticallib-i18n-bukkit",
                "description": "Bukkit platform adapter providing a PersistentDataContainer-backed LangStorage implementation for Paper/Spigot servers.",
                "dependencies": [
                    {
                        "artifact": "project(:hyticallib-i18n-core)",
                        "scope": "api"
                    },
                    {
                        "artifact": "io.papermc.paper:paper-api:1.21.4-R0.1-SNAPSHOT",
                        "scope": "compileOnly"
                    }
                ]
            }
        ],
        "packages": [
            {
                "name": "dev.hytical.i18n",
                "path": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n",
                "classes": [
                    "FallbackMerger",
                    "I18nBootstrap",
                    "I18nBootstrap.Builder",
                    "I18nBootstrap.Builder.LocaleEntry",
                    "LangLoader",
                    "LangRegistry",
                    "LangService",
                    "LangStorage"
                ]
            },
            {
                "name": "dev.hytical.i18n.bukkit",
                "path": "hyticallib-i18n-bukkit/src/main/java/dev/hytical/i18n/bukkit",
                "classes": [
                    "PdcLangStorage"
                ]
            }
        ]
    },
    "classes": [
        {
            "name": "FallbackMerger",
            "fullyQualifiedName": "dev.hytical.i18n.FallbackMerger",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/FallbackMerger.java",
            "type": "class",
            "modifiers": [
                "public",
                "final"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Stateless utility class responsible for merging a locale-specific translation map on top of the default (fallback) translation map. Guarantees that any key missing from the target locale is filled by the default. Returns an immutable copy of the merged result.",
            "responsibilities": [
                "Merge a target locale map onto a defaults map so that all default keys are present",
                "Return an immutable Map.copyOf of the merged result"
            ],
            "constructors": [
                {
                    "parameters": [],
                    "modifiers": [
                        "private"
                    ],
                    "description": "Private no-arg constructor preventing instantiation; this is a static utility class."
                }
            ],
            "fields": [],
            "methods": [
                {
                    "name": "merge",
                    "returnType": "Map<String, String>",
                    "modifiers": [
                        "public",
                        "static"
                    ],
                    "parameters": [
                        {
                            "name": "defaults",
                            "type": "Map<String, String>"
                        },
                        {
                            "name": "target",
                            "type": "Map<String, String>"
                        }
                    ],
                    "throws": [],
                    "description": "Creates a new HashMap seeded with all entries from 'defaults', then overlays all entries from 'target' (overwriting any colliding keys). Returns an immutable copy via Map.copyOf. This ensures every key in the default language exists in the result, while locale-specific overrides take precedence.",
                    "input": "Two maps: the default language translations and the target locale translations.",
                    "output": "An immutable Map<String, String> containing the union of both maps with target taking precedence on collisions.",
                    "sideEffects": [],
                    "calls": [
                        "HashMap.<init>",
                        "HashMap.putAll",
                        "Map.copyOf"
                    ],
                    "calledBy": [
                        "I18nBootstrap.Builder.build"
                    ]
                }
            ],
            "dependencies": [
                "java.util.HashMap",
                "java.util.Map"
            ],
            "usedBy": [
                "I18nBootstrap.Builder"
            ],
            "lifecycle": "Stateless utility; no instance is ever created."
        },
        {
            "name": "I18nBootstrap",
            "fullyQualifiedName": "dev.hytical.i18n.I18nBootstrap",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/I18nBootstrap.java",
            "type": "class",
            "modifiers": [
                "public",
                "final"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Top-level façade and entry point for the i18n engine. Constructed exclusively via the inner Builder class. Holds the fully-initialized LangRegistry and LangService, exposing them through accessor methods. Consumer code interacts with I18nBootstrap.builder()...build() to wire up the engine.",
            "responsibilities": [
                "Provide a fluent Builder API for configuring the i18n engine",
                "Validate ISO language codes during build",
                "Load and merge all locale files during build",
                "Expose the LangRegistry and LangService to consumer code"
            ],
            "constructors": [
                {
                    "parameters": [
                        {
                            "name": "registry",
                            "type": "LangRegistry"
                        },
                        {
                            "name": "service",
                            "type": "LangService"
                        }
                    ],
                    "modifiers": [
                        "private"
                    ],
                    "description": "Private constructor accepting a fully-built registry and service. Only called from Builder.build()."
                }
            ],
            "fields": [
                {
                    "name": "registry",
                    "type": "LangRegistry",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "The resolved language registry containing all loaded and merged translations."
                },
                {
                    "name": "service",
                    "type": "LangService",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "The runtime service providing UUID-keyed cached message lookups."
                }
            ],
            "methods": [
                {
                    "name": "registry",
                    "returnType": "LangRegistry",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [],
                    "throws": [],
                    "description": "Returns the LangRegistry containing all registered locale translations.",
                    "input": "None",
                    "output": "The LangRegistry instance.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "service",
                    "returnType": "LangService",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [],
                    "throws": [],
                    "description": "Returns the LangService used for UUID-based runtime message resolution.",
                    "input": "None",
                    "output": "The LangService instance.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "builder",
                    "returnType": "Builder",
                    "modifiers": [
                        "public",
                        "static"
                    ],
                    "parameters": [],
                    "throws": [],
                    "description": "Factory method that creates and returns a new Builder instance for fluent configuration.",
                    "input": "None",
                    "output": "A new Builder instance.",
                    "sideEffects": [],
                    "calls": [
                        "Builder.<init>"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                }
            ],
            "dependencies": [
                "LangRegistry",
                "LangService",
                "LangLoader",
                "FallbackMerger",
                "LangStorage"
            ],
            "usedBy": [
                "Consumer code (plugin entry points)"
            ],
            "lifecycle": "Created once during plugin startup via Builder.build(). Lives for the duration of the plugin lifecycle."
        },
        {
            "name": "I18nBootstrap.Builder",
            "fullyQualifiedName": "dev.hytical.i18n.I18nBootstrap.Builder",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/I18nBootstrap.java",
            "type": "class",
            "modifiers": [
                "public",
                "static",
                "final"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Fluent builder for I18nBootstrap. Collects configuration (default language, default file supplier, additional locale entries, and a LangStorage implementation) then validates and assembles the full i18n engine in build().",
            "responsibilities": [
                "Collect configuration: default language, default file, locale entries, storage",
                "Validate all ISO language codes",
                "Load YAML translation files via LangLoader",
                "Merge each locale with defaults via FallbackMerger",
                "Construct LangRegistry, LangService, and I18nBootstrap"
            ],
            "constructors": [
                {
                    "parameters": [],
                    "modifiers": [
                        "private"
                    ],
                    "description": "Private no-arg constructor; called by I18nBootstrap.builder()."
                }
            ],
            "fields": [
                {
                    "name": "defaultLanguage",
                    "type": "String",
                    "modifiers": [
                        "private"
                    ],
                    "description": "The ISO code of the default/fallback language. Defaults to 'en_US'."
                },
                {
                    "name": "defaultFile",
                    "type": "Supplier<InputStream>",
                    "modifiers": [
                        "private"
                    ],
                    "description": "Supplier providing the InputStream for the default language YAML file."
                },
                {
                    "name": "localeEntries",
                    "type": "List<LocaleEntry>",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "Accumulated list of additional locale entries (lang code + file supplier) to register."
                },
                {
                    "name": "storage",
                    "type": "LangStorage",
                    "modifiers": [
                        "private"
                    ],
                    "description": "The LangStorage implementation for persisting per-player language preferences."
                }
            ],
            "methods": [
                {
                    "name": "defaultLanguage",
                    "returnType": "Builder",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Sets the default/fallback language ISO code.",
                    "input": "An ISO language code string (e.g. 'en_US').",
                    "output": "This Builder for chaining.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "defaultFile",
                    "returnType": "Builder",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "supplier",
                            "type": "Supplier<InputStream>"
                        }
                    ],
                    "throws": [],
                    "description": "Sets the supplier for the default language YAML file InputStream.",
                    "input": "A Supplier<InputStream> that produces the default locale file.",
                    "output": "This Builder for chaining.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "locale",
                    "returnType": "Builder",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        },
                        {
                            "name": "supplier",
                            "type": "Supplier<InputStream>"
                        }
                    ],
                    "throws": [],
                    "description": "Registers an additional locale with its ISO code and YAML file supplier.",
                    "input": "An ISO language code and a Supplier<InputStream> for its YAML file.",
                    "output": "This Builder for chaining.",
                    "sideEffects": [
                        "Adds a new LocaleEntry to localeEntries"
                    ],
                    "calls": [
                        "LocaleEntry.<init>"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "storage",
                    "returnType": "Builder",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "storage",
                            "type": "LangStorage"
                        }
                    ],
                    "throws": [],
                    "description": "Sets the LangStorage implementation.",
                    "input": "A LangStorage implementation.",
                    "output": "This Builder for chaining.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "build",
                    "returnType": "I18nBootstrap",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [],
                    "throws": [
                        "IllegalStateException",
                        "IllegalArgumentException"
                    ],
                    "description": "Validates configuration, loads the default YAML file, registers it in a new LangRegistry, iterates over all locale entries—validating ISO codes, loading YAML, merging with defaults via FallbackMerger—registers each merged map, constructs a LangService backed by the registry and storage, and returns a new I18nBootstrap instance.",
                    "input": "None (uses accumulated builder state).",
                    "output": "A fully initialized I18nBootstrap instance.",
                    "sideEffects": [
                        "Reads InputStreams from all suppliers",
                        "Populates the LangRegistry"
                    ],
                    "calls": [
                        "LangRegistry.validateISOCode",
                        "LangLoader.load",
                        "Map.copyOf",
                        "LangRegistry.<init>",
                        "LangRegistry.setDefaultLanguage",
                        "LangRegistry.register",
                        "FallbackMerger.merge",
                        "LangService.<init>",
                        "I18nBootstrap.<init>"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                }
            ],
            "dependencies": [
                "LangRegistry",
                "LangLoader",
                "FallbackMerger",
                "LangService",
                "LangStorage"
            ],
            "usedBy": [
                "Consumer code"
            ],
            "lifecycle": "Transient; created via I18nBootstrap.builder(), used to accumulate config, then discarded after build()."
        },
        {
            "name": "I18nBootstrap.Builder.LocaleEntry",
            "fullyQualifiedName": "dev.hytical.i18n.I18nBootstrap.Builder.LocaleEntry",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/I18nBootstrap.java",
            "type": "record",
            "modifiers": [
                "private"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Immutable data carrier pairing a language ISO code with its InputStream Supplier. Used internally by the Builder to defer file loading until build() is called.",
            "responsibilities": [
                "Hold a language code and its corresponding file supplier"
            ],
            "constructors": [
                {
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        },
                        {
                            "name": "supplier",
                            "type": "Supplier<InputStream>"
                        }
                    ],
                    "description": "Canonical record constructor."
                }
            ],
            "fields": [
                {
                    "name": "lang",
                    "type": "String",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "The ISO language code (e.g. 'vi_VN')."
                },
                {
                    "name": "supplier",
                    "type": "Supplier<InputStream>",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "Supplier producing the InputStream for the locale's YAML file."
                }
            ],
            "methods": [],
            "dependencies": [],
            "usedBy": [
                "I18nBootstrap.Builder"
            ],
            "lifecycle": "Created during Builder.locale() calls, consumed during Builder.build(), then garbage collected."
        },
        {
            "name": "LangLoader",
            "fullyQualifiedName": "dev.hytical.i18n.LangLoader",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/LangLoader.java",
            "type": "class",
            "modifiers": [
                "public",
                "final"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Stateless utility class that loads a YAML InputStream and flattens its nested map structure into a single-level dot-delimited key map. Non-string leaf values are converted via String.valueOf().",
            "responsibilities": [
                "Parse YAML from an InputStream using SnakeYAML",
                "Recursively flatten nested maps into dot-delimited keys",
                "Convert all leaf values to strings"
            ],
            "constructors": [
                {
                    "parameters": [],
                    "modifiers": [
                        "private"
                    ],
                    "description": "Private no-arg constructor preventing instantiation."
                }
            ],
            "fields": [
                {
                    "name": "YAML",
                    "type": "Yaml",
                    "modifiers": [
                        "private",
                        "static",
                        "final"
                    ],
                    "description": "Shared SnakeYAML parser instance reused across all load() calls."
                }
            ],
            "methods": [
                {
                    "name": "load",
                    "returnType": "Map<String, String>",
                    "modifiers": [
                        "public",
                        "static"
                    ],
                    "parameters": [
                        {
                            "name": "inputStream",
                            "type": "InputStream"
                        }
                    ],
                    "throws": [],
                    "description": "Parses the given InputStream as YAML, producing a Map<String, Object> tree, then flattens it into a Map<String, String> with dot-delimited keys. Returns Map.of() if the YAML is null or empty.",
                    "input": "An InputStream containing valid YAML content.",
                    "output": "A mutable Map<String, String> of flattened key-value pairs.",
                    "sideEffects": [
                        "Reads and potentially exhausts the InputStream"
                    ],
                    "calls": [
                        "Yaml.load",
                        "flatten"
                    ],
                    "calledBy": [
                        "I18nBootstrap.Builder.build"
                    ]
                },
                {
                    "name": "flatten",
                    "returnType": "void",
                    "modifiers": [
                        "private",
                        "static"
                    ],
                    "parameters": [
                        {
                            "name": "prefix",
                            "type": "String"
                        },
                        {
                            "name": "map",
                            "type": "Map<String, Object>"
                        },
                        {
                            "name": "result",
                            "type": "Map<String, String>"
                        }
                    ],
                    "throws": [],
                    "description": "Recursively traverses a nested map. For each entry: if the value is a Map, recurses with the key appended to the prefix (dot-separated); otherwise, converts the value to a String and puts the full dot-delimited key into result.",
                    "input": "A prefix string, a nested map, and the accumulator result map.",
                    "output": "None (mutates result map in place).",
                    "sideEffects": [
                        "Mutates the result map"
                    ],
                    "calls": [
                        "String.valueOf"
                    ],
                    "calledBy": [
                        "load",
                        "flatten (recursively)"
                    ]
                }
            ],
            "dependencies": [
                "org.yaml.snakeyaml.Yaml"
            ],
            "usedBy": [
                "I18nBootstrap.Builder"
            ],
            "lifecycle": "Stateless utility; no instance is ever created."
        },
        {
            "name": "LangRegistry",
            "fullyQualifiedName": "dev.hytical.i18n.LangRegistry",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/LangRegistry.java",
            "type": "class",
            "modifiers": [
                "public",
                "final"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Central registry mapping ISO language codes to their resolved translation maps. Supports registering languages, querying available languages, retrieving entire translation maps or individual messages, and falling back to the default language when a requested language is not found. Also provides static ISO code validation via regex.",
            "responsibilities": [
                "Store language-code-to-translation-map mappings",
                "Provide fallback to default language when a requested language is absent",
                "Validate ISO language codes (xx_XX format)",
                "Expose read-only view of registered language codes"
            ],
            "constructors": [
                {
                    "parameters": [],
                    "modifiers": [
                        "public"
                    ],
                    "description": "Default public no-arg constructor; initializes an empty registry with defaultLanguage='en_US'."
                }
            ],
            "fields": [
                {
                    "name": "ISO_PATTERN",
                    "type": "Pattern",
                    "modifiers": [
                        "private",
                        "static",
                        "final"
                    ],
                    "description": "Compiled regex '^[a-z]{2}_[A-Z]{2}$' enforcing ISO 639-1 language + ISO 3166-1 Alpha-2 country code format."
                },
                {
                    "name": "registry",
                    "type": "Map<String, Map<String, String>>",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "Internal HashMap mapping language codes to their translation maps."
                },
                {
                    "name": "defaultLanguage",
                    "type": "String",
                    "modifiers": [
                        "private"
                    ],
                    "description": "The fallback language code used when a requested language is not registered. Defaults to 'en_US'."
                }
            ],
            "methods": [
                {
                    "name": "register",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        },
                        {
                            "name": "translations",
                            "type": "Map<String, String>"
                        }
                    ],
                    "throws": [],
                    "description": "Registers a language code with its complete translation map in the internal registry.",
                    "input": "An ISO language code and its key-value translation map.",
                    "output": "None.",
                    "sideEffects": [
                        "Mutates internal registry map"
                    ],
                    "calls": [],
                    "calledBy": [
                        "I18nBootstrap.Builder.build"
                    ]
                },
                {
                    "name": "getLanguages",
                    "returnType": "Set<String>",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [],
                    "throws": [],
                    "description": "Returns an unmodifiable view of all registered language codes.",
                    "input": "None.",
                    "output": "Unmodifiable Set of language code strings.",
                    "sideEffects": [],
                    "calls": [
                        "Collections.unmodifiableSet"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "containsLanguage",
                    "returnType": "boolean",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Checks whether a given language code has been registered.",
                    "input": "A language code.",
                    "output": "true if registered, false otherwise.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "getLanguageMap",
                    "returnType": "Map<String, String>",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Returns the translation map for the specified language. If the language is not found, falls back to the default language's map. If even the default is absent, returns Map.of().",
                    "input": "A language code.",
                    "output": "The translation map for that language (or the fallback).",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "LangService.resolve",
                        "LangService.setLanguage"
                    ]
                },
                {
                    "name": "getMessage",
                    "returnType": "String",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        },
                        {
                            "name": "address",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Retrieves a single message by its dot-delimited key from the specified language's map (with fallback).",
                    "input": "A language code and a message address.",
                    "output": "The message string, or null if not found.",
                    "sideEffects": [],
                    "calls": [
                        "getLanguageMap"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "hasKey",
                    "returnType": "boolean",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        },
                        {
                            "name": "address",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Checks whether a message key exists in the specified language's translation map (with fallback).",
                    "input": "A language code and a message address.",
                    "output": "true if key exists.",
                    "sideEffects": [],
                    "calls": [
                        "getLanguageMap"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "getDefaultLanguage",
                    "returnType": "String",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [],
                    "throws": [],
                    "description": "Returns the current default/fallback language code.",
                    "input": "None.",
                    "output": "The default language code string.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "setDefaultLanguage",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Sets the default/fallback language code.",
                    "input": "An ISO language code.",
                    "output": "None.",
                    "sideEffects": [
                        "Mutates defaultLanguage field"
                    ],
                    "calls": [],
                    "calledBy": [
                        "I18nBootstrap.Builder.build"
                    ]
                },
                {
                    "name": "validateISOCode",
                    "returnType": "boolean",
                    "modifiers": [
                        "public",
                        "static"
                    ],
                    "parameters": [
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Validates that a language code matches the pattern xx_XX (ISO 639-1 + ISO 3166-1 Alpha-2).",
                    "input": "A candidate language code string.",
                    "output": "true if valid, false otherwise.",
                    "sideEffects": [],
                    "calls": [
                        "Pattern.matcher"
                    ],
                    "calledBy": [
                        "I18nBootstrap.Builder.build"
                    ]
                }
            ],
            "dependencies": [
                "java.util.regex.Pattern",
                "java.util.Collections"
            ],
            "usedBy": [
                "I18nBootstrap",
                "I18nBootstrap.Builder",
                "LangService"
            ],
            "lifecycle": "Created once during I18nBootstrap.Builder.build(). Populated during bootstrap, then used as a read-only lookup structure at runtime."
        },
        {
            "name": "LangService",
            "fullyQualifiedName": "dev.hytical.i18n.LangService",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/LangService.java",
            "type": "class",
            "modifiers": [
                "public",
                "final"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Runtime service providing O(1) UUID-keyed message lookups. Maintains two ConcurrentHashMap caches: one mapping UUID→resolved translation Map, another mapping UUID→language code. On first access for a UUID, reads the player's language preference from LangStorage, resolves the full translation map from LangRegistry, and caches both. Supports explicit set, invalidation, and reload operations.",
            "responsibilities": [
                "Provide fast cached message lookups by UUID and message address",
                "Lazily resolve player language from LangStorage on first access",
                "Cache resolved translation maps per UUID for O(1) subsequent lookups",
                "Delegate language persistence to LangStorage on set operations",
                "Support cache invalidation and reload"
            ],
            "constructors": [
                {
                    "parameters": [
                        {
                            "name": "registry",
                            "type": "LangRegistry"
                        },
                        {
                            "name": "storage",
                            "type": "LangStorage"
                        }
                    ],
                    "modifiers": [
                        "public"
                    ],
                    "description": "Constructs a LangService backed by the given registry and storage."
                }
            ],
            "fields": [
                {
                    "name": "registry",
                    "type": "LangRegistry",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "Reference to the language registry for resolving translation maps."
                },
                {
                    "name": "storage",
                    "type": "LangStorage",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "Reference to the storage backend for reading/writing player language preferences."
                },
                {
                    "name": "cache",
                    "type": "Map<UUID, Map<String, String>>",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "ConcurrentHashMap caching UUID → resolved translation map for O(1) lookups."
                },
                {
                    "name": "langCache",
                    "type": "Map<UUID, String>",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "ConcurrentHashMap caching UUID → language code string."
                }
            ],
            "methods": [
                {
                    "name": "get",
                    "returnType": "String",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        },
                        {
                            "name": "address",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Returns the message for the given UUID and address. If the UUID is not yet cached, triggers lazy resolution via resolve().",
                    "input": "A player UUID and a dot-delimited message key.",
                    "output": "The message string, or null.",
                    "sideEffects": [
                        "May populate cache and langCache on first access"
                    ],
                    "calls": [
                        "resolve"
                    ],
                    "calledBy": [
                        "getOrDefault",
                        "Consumer code"
                    ]
                },
                {
                    "name": "getOrDefault",
                    "returnType": "String",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        },
                        {
                            "name": "address",
                            "type": "String"
                        },
                        {
                            "name": "fallback",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Returns the message for the given UUID and address, or the fallback string if null.",
                    "input": "UUID, message key, fallback string.",
                    "output": "The resolved or fallback message.",
                    "sideEffects": [],
                    "calls": [
                        "get"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "getLanguage",
                    "returnType": "String",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Returns the language code for the given UUID. If not cached, reads from storage and caches.",
                    "input": "A player UUID.",
                    "output": "The ISO language code.",
                    "sideEffects": [
                        "May populate langCache"
                    ],
                    "calls": [
                        "LangStorage.read"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "setLanguage",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        },
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Persists a new language preference for the UUID via storage, updates the langCache, and re-resolves the translation map from the registry into the cache.",
                    "input": "A player UUID and new ISO language code.",
                    "output": "None.",
                    "sideEffects": [
                        "Writes to LangStorage",
                        "Updates both caches"
                    ],
                    "calls": [
                        "LangStorage.write",
                        "LangRegistry.getLanguageMap"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "hasLanguage",
                    "returnType": "boolean",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Returns true if the UUID has a cached language or translation map.",
                    "input": "A player UUID.",
                    "output": "Boolean.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "invalidate",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Removes the UUID from both caches, forcing re-resolution on next access.",
                    "input": "A player UUID.",
                    "output": "None.",
                    "sideEffects": [
                        "Removes entries from cache and langCache"
                    ],
                    "calls": [],
                    "calledBy": [
                        "reload",
                        "Consumer code"
                    ]
                },
                {
                    "name": "invalidateAll",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [],
                    "throws": [],
                    "description": "Clears both caches entirely.",
                    "input": "None.",
                    "output": "None.",
                    "sideEffects": [
                        "Clears cache and langCache"
                    ],
                    "calls": [],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "reload",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Invalidates the UUID's cache entries, then immediately re-resolves from storage.",
                    "input": "A player UUID.",
                    "output": "None.",
                    "sideEffects": [
                        "Clears and re-populates cache entries for this UUID"
                    ],
                    "calls": [
                        "invalidate",
                        "resolve"
                    ],
                    "calledBy": [
                        "Consumer code"
                    ]
                },
                {
                    "name": "resolve",
                    "returnType": "Map<String, String>",
                    "modifiers": [
                        "private"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Reads the player's language from storage, caches the language code, retrieves the full translation map from the registry, caches it, and returns it.",
                    "input": "A player UUID.",
                    "output": "The resolved translation map.",
                    "sideEffects": [
                        "Reads from LangStorage",
                        "Populates cache and langCache"
                    ],
                    "calls": [
                        "LangStorage.read",
                        "LangRegistry.getLanguageMap"
                    ],
                    "calledBy": [
                        "get",
                        "reload"
                    ]
                }
            ],
            "dependencies": [
                "LangRegistry",
                "LangStorage",
                "java.util.concurrent.ConcurrentHashMap"
            ],
            "usedBy": [
                "I18nBootstrap",
                "Consumer code"
            ],
            "lifecycle": "Created during I18nBootstrap.Builder.build(). Lives for the plugin lifetime. Caches grow as players join; invalidated on reload or player quit."
        },
        {
            "name": "LangStorage",
            "fullyQualifiedName": "dev.hytical.i18n.LangStorage",
            "filePath": "hyticallib-i18n-core/src/main/java/dev/hytical/i18n/LangStorage.java",
            "type": "interface",
            "modifiers": [
                "public"
            ],
            "extends": null,
            "implements": [],
            "annotations": [],
            "description": "Platform-agnostic SPI interface for persisting and retrieving per-player language preferences. Implementations are provided by platform-specific modules (e.g. PdcLangStorage for Bukkit).",
            "responsibilities": [
                "Define the contract for reading a player's stored language preference",
                "Define the contract for writing a player's language preference"
            ],
            "constructors": [],
            "fields": [],
            "methods": [
                {
                    "name": "read",
                    "returnType": "String",
                    "modifiers": [
                        "public",
                        "abstract"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Reads the stored language preference for the given player UUID. Returns the ISO language code.",
                    "input": "A player UUID.",
                    "output": "The stored ISO language code, or a default.",
                    "sideEffects": [],
                    "calls": [],
                    "calledBy": [
                        "LangService.resolve",
                        "LangService.getLanguage"
                    ]
                },
                {
                    "name": "write",
                    "returnType": "void",
                    "modifiers": [
                        "public",
                        "abstract"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        },
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Persists the language preference for the given player UUID.",
                    "input": "A player UUID and an ISO language code.",
                    "output": "None.",
                    "sideEffects": [
                        "Persists data to platform storage"
                    ],
                    "calls": [],
                    "calledBy": [
                        "LangService.setLanguage"
                    ]
                }
            ],
            "dependencies": [
                "java.util.UUID"
            ],
            "usedBy": [
                "LangService",
                "I18nBootstrap.Builder"
            ],
            "lifecycle": "Provided by consumer code to the Builder. Lives for the plugin lifetime."
        },
        {
            "name": "PdcLangStorage",
            "fullyQualifiedName": "dev.hytical.i18n.bukkit.PdcLangStorage",
            "filePath": "hyticallib-i18n-bukkit/src/main/java/dev/hytical/i18n/bukkit/PdcLangStorage.java",
            "type": "class",
            "modifiers": [
                "public",
                "final"
            ],
            "extends": null,
            "implements": [
                "LangStorage"
            ],
            "annotations": [],
            "description": "Bukkit-specific LangStorage implementation that persists player language preferences using the Bukkit Persistent Data Container (PDC) API. Stores the language code as a STRING-typed PDC entry under a NamespacedKey scoped to the plugin. Falls back to 'en_US' if the player is offline or has no stored preference.",
            "responsibilities": [
                "Read player language from PDC on online players",
                "Write player language to PDC on online players",
                "Fall back to DEFAULT_LANGUAGE when player is offline or has no stored value"
            ],
            "constructors": [
                {
                    "parameters": [
                        {
                            "name": "plugin",
                            "type": "Plugin"
                        }
                    ],
                    "modifiers": [
                        "public"
                    ],
                    "description": "Creates a PdcLangStorage scoped to the given Bukkit plugin, constructing a NamespacedKey('lang') under that plugin's namespace."
                }
            ],
            "fields": [
                {
                    "name": "DEFAULT_LANGUAGE",
                    "type": "String",
                    "modifiers": [
                        "private",
                        "static",
                        "final"
                    ],
                    "description": "Hardcoded fallback language code 'en_US' used when no PDC value is found or player is offline."
                },
                {
                    "name": "key",
                    "type": "NamespacedKey",
                    "modifiers": [
                        "private",
                        "final"
                    ],
                    "description": "The PDC key under which the language preference STRING is stored, scoped to the plugin namespace with key name 'lang'."
                }
            ],
            "methods": [
                {
                    "name": "read",
                    "returnType": "String",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        }
                    ],
                    "throws": [],
                    "description": "Looks up the Player by UUID via Bukkit.getPlayer(). If the player is null (offline), returns DEFAULT_LANGUAGE. Otherwise reads the STRING value from the player's PDC under the stored key. Returns DEFAULT_LANGUAGE if no value is set.",
                    "input": "A player UUID.",
                    "output": "The stored ISO language code or 'en_US'.",
                    "sideEffects": [],
                    "calls": [
                        "Bukkit.getPlayer",
                        "Player.getPersistentDataContainer",
                        "PersistentDataContainer.get"
                    ],
                    "calledBy": [
                        "LangService.resolve",
                        "LangService.getLanguage"
                    ]
                },
                {
                    "name": "write",
                    "returnType": "void",
                    "modifiers": [
                        "public"
                    ],
                    "parameters": [
                        {
                            "name": "uuid",
                            "type": "UUID"
                        },
                        {
                            "name": "lang",
                            "type": "String"
                        }
                    ],
                    "throws": [],
                    "description": "Looks up the Player by UUID. If player is null (offline), silently returns. Otherwise writes the language string into the player's PDC under the stored key.",
                    "input": "A player UUID and an ISO language code.",
                    "output": "None.",
                    "sideEffects": [
                        "Modifies the player's PersistentDataContainer"
                    ],
                    "calls": [
                        "Bukkit.getPlayer",
                        "Player.getPersistentDataContainer",
                        "PersistentDataContainer.set"
                    ],
                    "calledBy": [
                        "LangService.setLanguage"
                    ]
                }
            ],
            "dependencies": [
                "dev.hytical.i18n.LangStorage",
                "org.bukkit.Bukkit",
                "org.bukkit.NamespacedKey",
                "org.bukkit.entity.Player",
                "org.bukkit.persistence.PersistentDataContainer",
                "org.bukkit.persistence.PersistentDataType",
                "org.bukkit.plugin.Plugin"
            ],
            "usedBy": [
                "Consumer Bukkit plugin code (passed to I18nBootstrap.Builder.storage())"
            ],
            "lifecycle": "Created once during plugin onEnable(), passed to the I18nBootstrap Builder. Lives for the plugin lifetime."
        }
    ],
    "relationships": {
        "inheritanceGraph": [
            {
                "child": "dev.hytical.i18n.bukkit.PdcLangStorage",
                "parent": "dev.hytical.i18n.LangStorage",
                "type": "implements"
            }
        ],
        "dependencyGraph": [
            {
                "from": "I18nBootstrap",
                "to": "LangRegistry",
                "type": "composition"
            },
            {
                "from": "I18nBootstrap",
                "to": "LangService",
                "type": "composition"
            },
            {
                "from": "I18nBootstrap.Builder",
                "to": "LangLoader",
                "type": "uses"
            },
            {
                "from": "I18nBootstrap.Builder",
                "to": "FallbackMerger",
                "type": "uses"
            },
            {
                "from": "I18nBootstrap.Builder",
                "to": "LangRegistry",
                "type": "creates"
            },
            {
                "from": "I18nBootstrap.Builder",
                "to": "LangService",
                "type": "creates"
            },
            {
                "from": "I18nBootstrap.Builder",
                "to": "LangStorage",
                "type": "depends-on (injected)"
            },
            {
                "from": "LangService",
                "to": "LangRegistry",
                "type": "depends-on"
            },
            {
                "from": "LangService",
                "to": "LangStorage",
                "type": "depends-on"
            },
            {
                "from": "LangLoader",
                "to": "org.yaml.snakeyaml.Yaml",
                "type": "depends-on"
            },
            {
                "from": "PdcLangStorage",
                "to": "org.bukkit (Paper API)",
                "type": "depends-on"
            },
            {
                "from": "hyticallib-i18n-bukkit",
                "to": "hyticallib-i18n-core",
                "type": "module-dependency"
            }
        ],
        "callGraph": [
            {
                "caller": "I18nBootstrap.Builder.build",
                "callee": "LangRegistry.validateISOCode"
            },
            {
                "caller": "I18nBootstrap.Builder.build",
                "callee": "LangLoader.load"
            },
            {
                "caller": "I18nBootstrap.Builder.build",
                "callee": "FallbackMerger.merge"
            },
            {
                "caller": "I18nBootstrap.Builder.build",
                "callee": "LangRegistry.register"
            },
            {
                "caller": "I18nBootstrap.Builder.build",
                "callee": "LangRegistry.setDefaultLanguage"
            },
            {
                "caller": "LangService.get",
                "callee": "LangService.resolve"
            },
            {
                "caller": "LangService.resolve",
                "callee": "LangStorage.read"
            },
            {
                "caller": "LangService.resolve",
                "callee": "LangRegistry.getLanguageMap"
            },
            {
                "caller": "LangService.setLanguage",
                "callee": "LangStorage.write"
            },
            {
                "caller": "LangService.setLanguage",
                "callee": "LangRegistry.getLanguageMap"
            },
            {
                "caller": "LangService.getLanguage",
                "callee": "LangStorage.read"
            },
            {
                "caller": "LangService.reload",
                "callee": "LangService.invalidate"
            },
            {
                "caller": "LangService.reload",
                "callee": "LangService.resolve"
            },
            {
                "caller": "LangService.getOrDefault",
                "callee": "LangService.get"
            },
            {
                "caller": "PdcLangStorage.read",
                "callee": "Bukkit.getPlayer"
            },
            {
                "caller": "PdcLangStorage.write",
                "callee": "Bukkit.getPlayer"
            }
        ]
    },
    "runtime": {
        "initializationFlow": [
            "1. Consumer plugin calls I18nBootstrap.builder()",
            "2. Builder accumulates config: defaultLanguage, defaultFile supplier, locale entries, LangStorage impl",
            "3. Builder.build() validates all ISO codes via LangRegistry.validateISOCode()",
            "4. Builder.build() loads default YAML via LangLoader.load() → produces immutable default translations",
            "5. Builder.build() creates LangRegistry, sets default language, registers default translations",
            "6. For each additional locale: loads YAML, merges with defaults via FallbackMerger.merge(), registers in registry",
            "7. Builder.build() creates LangService(registry, storage)",
            "8. Builder.build() returns I18nBootstrap holding registry + service",
            "9. Consumer stores the I18nBootstrap instance for runtime use"
        ],
        "eventFlow": [
            "Player join → consumer code may call service.getLanguage(uuid) or service.get(uuid, key) triggering lazy resolve",
            "Player language change → consumer calls service.setLanguage(uuid, lang) → persists to storage + updates both caches",
            "Player quit → consumer may call service.invalidate(uuid) to free memory",
            "Plugin reload → consumer may call service.invalidateAll() to force re-resolution"
        ],
        "dataFlow": [
            "YAML files → LangLoader.load() → Map<String,String> → FallbackMerger.merge() → LangRegistry",
            "LangStorage.read(uuid) → language code → LangRegistry.getLanguageMap(lang) → cached in LangService",
            "LangService.get(uuid, address) → cached Map lookup → message String"
        ],
        "threadingModel": "LangService uses ConcurrentHashMap for both caches, making read/write operations thread-safe. LangRegistry is populated during single-threaded bootstrap and treated as effectively immutable at runtime. PdcLangStorage accesses Bukkit API which must be called from the main server thread.",
        "asyncBoundaries": [
            "PdcLangStorage.read() and write() require main-thread execution (Bukkit API constraint)",
            "LangService cache operations are thread-safe via ConcurrentHashMap but resolve() delegates to storage which may have thread affinity requirements"
        ]
    }
}